var appjs = require("appjs");
var http = require("http");
var exec = require("child_process").exec;

appjs.serveFilesFrom(__dirname + "/content");

// create a window
var window = appjs.createWindow({
    width: 640,
    height: 460,
    alpha: true,
    showChrome: true
});

var token = process.argv[2];

appjs.router.post("/pcp/update", function(request, response, next){
    //redirect the http request to the gpii local server (localhost:8081)   

    response.send(204);
});

// prepare the window when first created
window.on("create", function(){
    // window.frame controls the desktop window
    window.frame.show().center();
});

// the window is ready when the DOM is loaded
window.on("ready", function(){
    // directly interact with the DOM
    window.process = process;
    window.module = module;
});

// cleanup code when window is closed
window.on("close", function(){
    console.log("Window Closed");
});
